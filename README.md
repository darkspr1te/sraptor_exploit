Original Idea from pdf found on offzone russia about STM clones exploits 
There was no available POC code so i decided to swrite my own - pun intended 

This code makes use of two SRAM based exploits for CKS -aka- cks32f103c8t6 and GD aka GigaDevices gd32f103cc based stm32f103 clones 
for the cks this should just work, for the gd32 devies you need to apply either power domain exploit or hope it's rdp1 
how to use :-

compile the code with build.sh file 
load up openocd and connect to target - some targets may need BOOT0 and BOOT1 changed, for cks targets you only need to change boot0 , for GD32 targets you need to connect under reset 
openocd  -f interface/stlink.cfg  -f stm32f1x.cfg
openocd  -f interface/ftdi/dp_busblaster_kt-link.cfg  -c 'transport select swd' -f gd32f103.cfg

then issue the following commands 
     reset halt
     load_image  load_image sram-code/uart.sram.elf
     resume 0x20000001


if connected correctly to UART1 PA9/PA10 then you will see the flash dump via uart


*notes*
to use the stm32f103.cfg on cks targets you need to change the ID from  0x1ba01477 to 0x2ba01477 
just copy it to local place and edit the use -f stm32f103.cfg to load local file 


code should be injectable into binaries too tested on 2 Logitech keyboards


**code is provided for educational purpose only ** 



darkspr1te - 12-12-2023


